// ==================== 投篮机器人转速预测代码 (SVR模型) ====================
// 输入: 到篮筐的距离 (米)
// 输出: 电机转速 (RPM)
// 模型类型: RBF核支持向量回归
// 支持向量数: 178
// 测试集性能: 
//   MAE = 108.3 RPM
//   R² = 0.1820

#include <math.h>

// -------------------- 1. 归一化参数 --------------------
// 特征归一化范围 (训练时使用MinMaxScaler)
const float feat_min[6] = {0.104091f, 0.010835f, 0.330724f, -2.262476f, 0.322632f, 0.473966f};
const float feat_max[6] = {3.023668f, 9.142568f, 9.606843f, 1.106471f, 1.738870f, 1.440709f};

const float rpm_min = 978.8f;
const float rpm_max = 1756.8f;

// -------------------- 2. SVR模型参数 --------------------
const float gamma = 10.000000f;  // RBF核参数
const float intercept = 0.333991f;

// 支持向量 (共178个)
const float support_vectors[178][6] = {
    {0.133484f, -0.324920f, -0.948715f, 0.678313f, 0.417195f, 0.511960f},
    {-0.904022f, -0.989312f, -0.188395f, -0.493783f, -0.757762f, -0.681346f},
    {0.235344f, -0.205527f, -0.958271f, 0.726494f, 0.494757f, 0.579618f},
    {-0.502908f, -0.851587f, -0.811458f, 0.232334f, -0.169251f, -0.035316f},
    {-0.315611f, -0.735841f, -0.875861f, 0.401418f, 0.027624f, 0.156382f},
    {0.666839f, 0.407657f, -0.986332f, 0.895896f, 0.793860f, 0.832415f},
    {-0.017474f, -0.484052f, -0.931154f, 0.598838f, 0.295939f, 0.404243f},
    {-0.389572f, -0.785460f, -0.854657f, 0.340272f, -0.046829f, 0.084969f},
    {0.030139f, -0.436157f, -0.937212f, 0.625072f, 0.335071f, 0.439275f},
    {-0.987933f, -0.999129f, 0.700213f, -0.907186f, -0.962954f, -0.948083f},
    {-0.027415f, -0.493784f, -0.929819f, 0.593212f, 0.287658f, 0.396796f},
    {-0.355903f, -0.763505f, -0.864853f, 0.368890f, -0.012459f, 0.118091f},
    {-0.435406f, -0.813646f, -0.839041f, 0.298954f, -0.095010f, 0.038071f},
    {-0.572537f, -0.886267f, -0.775183f, 0.154757f, -0.250614f, -0.117419f},
    {0.049382f, -0.416200f, -0.939515f, 0.635354f, 0.350645f, 0.453144f},
    {-0.130762f, -0.589502f, -0.914272f, 0.531322f, 0.199115f, 0.316398f},
    {-0.222574f, -0.666173f, -0.897285f, 0.470345f, 0.116279f, 0.239847f},
    {0.052726f, -0.412697f, -0.939907f, 0.637123f, 0.353338f, 0.455538f},
    {0.011479f, -0.455180f, -0.934901f, 0.614928f, 0.319837f, 0.425668f},
    {-0.345436f, -0.756464f, -0.867830f, 0.377513f, -0.001941f, 0.128174f},
    {-0.208842f, -0.655206f, -0.900056f, 0.479873f, 0.128944f, 0.251638f},
    {-0.589501f, -0.894031f, -0.764756f, 0.134213f, -0.271284f, -0.138574f},
    {0.377002f, -0.023382f, -0.969327f, 0.787600f, 0.597761f, 0.668073f},
    {0.288361f, -0.139551f, -0.962679f, 0.750106f, 0.533932f, 0.613442f},
    {-0.067072f, -0.531693f, -0.924232f, 0.570219f, 0.254224f, 0.366604f},
    {-0.157088f, -0.612291f, -0.909750f, 0.514468f, 0.175793f, 0.294980f},
    {0.639117f, 0.363038f, -0.984955f, 0.886351f, 0.775849f, 0.817529f},
    {-0.119189f, -0.579279f, -0.916181f, 0.538582f, 0.209265f, 0.325687f},
    {0.339559f, -0.073347f, -0.966621f, 0.772050f, 0.571045f, 0.645278f},
    {0.239068f, -0.200977f, -0.958592f, 0.728184f, 0.497535f, 0.582024f},
    {0.539788f, 0.209056f, -0.979631f, 0.850834f, 0.710086f, 0.762829f},
    {0.802733f, 0.636758f, -0.992494f, 0.940585f, 0.880141f, 0.903168f},
    {0.412336f, 0.024968f, -0.971756f, 0.801909f, 0.622658f, 0.689224f},
    {-0.178964f, -0.630736f, -0.905790f, 0.500090f, 0.156156f, 0.276866f},
    {0.631993f, 0.351688f, -0.984594f, 0.883873f, 0.771197f, 0.813678f},
    {-0.377746f, -0.777869f, -0.858351f, 0.350482f, -0.034662f, 0.096725f},
    {0.625801f, 0.341861f, -0.984277f, 0.881711f, 0.767146f, 0.810322f},
    {-0.755297f, -0.955766f, -0.603923f, -0.116172f, -0.496464f, -0.377904f},
    {0.200878f, -0.247008f, -0.955209f, 0.710625f, 0.468863f, 0.557134f},
    {0.501301f, 0.151869f, -0.977388f, 0.836480f, 0.684062f, 0.741027f},
    {-0.991563f, -0.999405f, 0.780848f, -0.933611f, -0.973798f, -0.963138f},
    {-0.723397f, -0.945881f, -0.646777f, -0.059081f, -0.449217f, -0.326227f},
    {-0.113367f, -0.574089f, -0.917124f, 0.542201f, 0.214348f, 0.330332f},
    {0.538518f, 0.207147f, -0.979559f, 0.850366f, 0.709232f, 0.762115f},
    {-0.967808f, -0.997374f, 0.355743f, -0.778821f, -0.906704f, -0.871719f},
    {-0.881493f, -0.985558f, -0.293188f, -0.418776f, -0.712254f, -0.626031f},
    {-0.215301f, -0.660387f, -0.898764f, 0.475410f, 0.122999f, 0.246107f},
    {-0.054325f, -0.519668f, -0.926075f, 0.577707f, 0.265042f, 0.376395f},
    {-0.194702f, -0.643729f, -0.902818f, 0.489527f, 0.141880f, 0.263649f},
    {-0.180899f, -0.632346f, -0.905430f, 0.498801f, 0.154408f, 0.275249f},
    {0.372886f, -0.028940f, -0.969036f, 0.785910f, 0.594841f, 0.665586f},
    {0.015819f, -0.450784f, -0.935446f, 0.617303f, 0.323392f, 0.428847f},
    {0.433795f, 0.054901f, -0.973175f, 0.810434f, 0.637634f, 0.701906f},
    {-0.131999f, -0.590587f, -0.914066f, 0.530541f, 0.198028f, 0.315402f},
    {-0.934684f, -0.993661f, 0.009757f, -0.613984f, -0.824953f, -0.765318f},
    {-0.056918f, -0.522127f, -0.925704f, 0.576192f, 0.262847f, 0.374409f},
    {-0.135608f, -0.593745f, -0.913459f, 0.528255f, 0.194848f, 0.312487f},
    {-0.024933f, -0.491363f, -0.930155f, 0.594622f, 0.289730f, 0.398660f},
    {-0.376659f, -0.777165f, -0.858684f, 0.351411f, -0.033549f, 0.097799f},
    {-0.605754f, -0.901217f, -0.754054f, 0.113842f, -0.291431f, -0.159315f},
    {-0.086318f, -0.549561f, -0.921358f, 0.558732f, 0.237761f, 0.351664f},
    {-0.437401f, -0.814828f, -0.838310f, 0.297089f, -0.097146f, 0.035978f},
    {-0.626364f, -0.909975f, -0.739359f, 0.086961f, -0.317492f, -0.186326f},
    {0.073036f, -0.391195f, -0.942239f, 0.647754f, 0.369608f, 0.469977f},
    {-0.504551f, -0.852457f, -0.810704f, 0.230616f, -0.171112f, -0.037173f},
    {-0.029296f, -0.495616f, -0.929563f, 0.592141f, 0.286087f, 0.395381f},
    {-0.128535f, -0.587545f, -0.914643f, 0.532726f, 0.201073f, 0.318192f},
    {-0.137922f, -0.595764f, -0.913068f, 0.526785f, 0.192805f, 0.310613f},
    {-0.389970f, -0.785713f, -0.854530f, 0.339926f, -0.047240f, 0.084572f},
    {-0.596287f, -0.897061f, -0.760376f, 0.125792f, -0.279655f, -0.147176f},
    {-0.397883f, -0.790716f, -0.851983f, 0.332990f, -0.055443f, 0.076625f},
    {-0.983623f, -0.998785f, 0.613142f, -0.877266f, -0.950382f, -0.930767f},
    {-0.635387f, -0.913685f, -0.732488f, 0.074798f, -0.329092f, -0.198416f},
    {-0.433879f, -0.812739f, -0.839597f, 0.300378f, -0.093378f, 0.039669f},
    {-0.744375f, -0.952488f, -0.619537f, -0.096001f, -0.480030f, -0.359833f},
    {0.358540f, -0.048183f, -0.968010f, 0.779983f, 0.584631f, 0.656883f},
    {-0.193653f, -0.642870f, -0.903020f, 0.490237f, 0.142836f, 0.264535f},
    {-0.648676f, -0.919010f, -0.721834f, 0.056419f, -0.346396f, -0.216530f},
    {-0.748667f, -0.953790f, -0.613527f, -0.103847f, -0.486456f, -0.366886f},
    {-0.071007f, -0.535374f, -0.923653f, 0.567889f, 0.250871f, 0.363565f},
    {-0.202086f, -0.649746f, -0.901387f, 0.484505f, 0.135138f, 0.257393f},
    {-0.380001f, -0.779326f, -0.857656f, 0.348548f, -0.036974f, 0.094494f},
    {0.312930f, -0.108087f, -0.964607f, 0.760738f, 0.551827f, 0.628818f},
    {0.241810f, -0.197620f, -0.958828f, 0.729425f, 0.499577f, 0.583792f},
    {-0.129391f, -0.588297f, -0.914501f, 0.532187f, 0.200322f, 0.317503f},
    {0.124731f, -0.334728f, -0.947817f, 0.673984f, 0.410379f, 0.505969f},
    {0.232586f, -0.208886f, -0.958032f, 0.725240f, 0.492698f, 0.577834f},
    {-0.020786f, -0.487305f, -0.930712f, 0.596970f, 0.293184f, 0.401767f},
    {-0.520991f, -0.861029f, -0.802919f, 0.213141f, -0.189879f, -0.055960f},
    {0.184295f, -0.266573f, -0.953676f, 0.702836f, 0.456279f, 0.546170f},
    {-0.060104f, -0.525138f, -0.925245f, 0.574325f, 0.260147f, 0.371967f},
    {0.510037f, 0.164728f, -0.977906f, 0.839769f, 0.689997f, 0.746007f},
    {0.035218f, -0.430924f, -0.937828f, 0.627803f, 0.339194f, 0.442951f},
    {-0.251965f, -0.689055f, -0.891043f, 0.449422f, 0.088822f, 0.214172f},
    {-1.000000f, -1.000000f, 1.000000f, -1.000000f, -1.000000f, -1.000000f},
    {-0.473794f, -0.835745f, -0.824119f, 0.261989f, -0.136718f, -0.002985f},
    {-0.159016f, -0.613935f, -0.909409f, 0.513215f, 0.174072f, 0.293395f},
    {-0.105223f, -0.566775f, -0.918424f, 0.547227f, 0.221432f, 0.336797f},
    {-0.883911f, -0.985983f, -0.283148f, -0.426387f, -0.717004f, -0.631750f},
    {-0.531539f, -0.866395f, -0.797674f, 0.201652f, -0.202068f, -0.068213f},
    {-0.071312f, -0.535659f, -0.923608f, 0.567707f, 0.250611f, 0.363329f},
    {0.584070f, 0.276566f, -0.982084f, 0.866931f, 0.739647f, 0.787487f},
    {-0.764799f, -0.958526f, -0.589433f, -0.134297f, -0.510995f, -0.393970f},
    {-0.039672f, -0.505657f, -0.928138f, 0.586200f, 0.277394f, 0.387548f},
    {-0.890809f, -0.987168f, -0.253027f, -0.448652f, -0.730725f, -0.648340f},
    {-0.443077f, -0.818172f, -0.836205f, 0.291750f, -0.103241f, 0.030002f},
    {-0.088797f, -0.551837f, -0.920980f, 0.557236f, 0.235628f, 0.349725f},
    {-0.077742f, -0.541642f, -0.922652f, 0.563878f, 0.245116f, 0.358345f},
    {-0.977665f, -0.998281f, 0.505957f, -0.838236f, -0.933497f, -0.907742f},
    {-0.330041f, -0.745923f, -0.872056f, 0.389972f, 0.013394f, 0.142829f},
    {0.247014f, -0.191229f, -0.959272f, 0.731773f, 0.503448f, 0.587142f},
    {-0.082711f, -0.546239f, -0.921905f, 0.560901f, 0.240858f, 0.354478f},
    {-0.079816f, -0.543563f, -0.922341f, 0.562637f, 0.243340f, 0.356733f},
    {-0.722333f, -0.945535f, -0.648072f, -0.057267f, -0.447679f, -0.324558f},
    {-0.148614f, -0.605026f, -0.911234f, 0.519946f, 0.183337f, 0.301919f},
    {0.130253f, -0.328549f, -0.948385f, 0.676718f, 0.414682f, 0.509752f},
    {0.709377f, 0.477517f, -0.988362f, 0.910249f, 0.821219f, 0.854948f},
    {0.509050f, 0.163271f, -0.977848f, 0.839398f, 0.689327f, 0.745445f},
    {-0.602236f, -0.899682f, -0.756433f, 0.118311f, -0.287041f, -0.154785f},
    {-0.265010f, -0.698952f, -0.888126f, 0.439894f, 0.076477f, 0.202579f},
    {0.471861f, 0.109057f, -0.975596f, 0.825261f, 0.663939f, 0.724107f},
    {-0.170248f, -0.623441f, -0.907391f, 0.505861f, 0.164009f, 0.284118f},
    {-0.085033f, -0.548379f, -0.921553f, 0.559505f, 0.238865f, 0.352667f},
    {-0.705086f, -0.939778f, -0.668004f, -0.028630f, -0.423072f, -0.297986f},
    {-0.901758f, -0.988956f, -0.200184f, -0.485802f, -0.753056f, -0.675569f},
    {-0.153344f, -0.609090f, -0.910409f, 0.516895f, 0.179131f, 0.298051f},
    {0.160536f, -0.294156f, -0.951407f, 0.691495f, 0.438103f, 0.530291f},
    {-0.516363f, -0.858641f, -0.805157f, 0.218113f, -0.184568f, -0.050634f},
    {0.223615f, -0.219768f, -0.957247f, 0.721141f, 0.485984f, 0.572012f},
    {-0.165719f, -0.619621f, -0.908211f, 0.508837f, 0.168074f, 0.287869f},
    {0.338408f, -0.074864f, -0.966535f, 0.771565f, 0.570217f, 0.644570f},
    {0.413816f, 0.027018f, -0.971855f, 0.802501f, 0.623694f, 0.690103f},
    {-0.384851f, -0.782445f, -0.856147f, 0.344369f, -0.041959f, 0.089679f},
    {0.554790f, 0.231723f, -0.980477f, 0.856337f, 0.720146f, 0.771233f},
    {-0.312593f, -0.733708f, -0.876638f, 0.403784f, 0.030583f, 0.159195f},
    {-0.758979f, -0.956845f, -0.598413f, -0.123130f, -0.502069f, -0.384090f},
    {0.089795f, -0.373162f, -0.944102f, 0.656385f, 0.382924f, 0.481762f},
    {-0.326476f, -0.743450f, -0.873009f, 0.392820f, 0.016922f, 0.146194f},
    {0.619770f, 0.332325f, -0.983967f, 0.879598f, 0.763193f, 0.807046f},
    {-0.466185f, -0.831473f, -0.827227f, 0.269502f, -0.128346f, 0.005291f},
    {-0.003641f, -0.470355f, -0.932969f, 0.606580f, 0.307397f, 0.414528f},
    {0.488072f, 0.132531f, -0.976591f, 0.831465f, 0.675043f, 0.733450f},
    {0.176154f, -0.276084f, -0.952908f, 0.698974f, 0.450071f, 0.540752f},
    {1.000000f, 1.000000f, -1.000000f, 1.000000f, 1.000000f, 1.000000f},
    {-0.530700f, -0.865972f, -0.798099f, 0.202574f, -0.201094f, -0.067232f},
    {-0.012531f, -0.479178f, -0.931808f, 0.601616f, 0.300042f, 0.407928f},
    {-0.771123f, -0.960317f, -0.579282f, -0.146673f, -0.520791f, -0.404847f},
    {0.043217f, -0.422631f, -0.938786f, 0.632079f, 0.345670f, 0.448718f},
    {-0.461842f, -0.829012f, -0.828966f, 0.273746f, -0.123593f, 0.009982f},
    {-0.995360f, -0.999681f, 0.873455f, -0.962576f, -0.985410f, -0.979388f},
    {0.891718f, 0.796116f, -0.996067f, 0.968125f, 0.934952f, 0.947654f},
    {0.158869f, -0.296072f, -0.951244f, 0.690691f, 0.436822f, 0.529169f},
    {-0.405706f, -0.795605f, -0.849405f, 0.326054f, -0.063599f, 0.068709f},
    {-0.558528f, -0.879653f, -0.783273f, 0.171201f, -0.233809f, -0.100310f},
    {-0.153527f, -0.609246f, -0.910377f, 0.516776f, 0.178968f, 0.297902f},
    {0.429280f, 0.048568f, -0.972880f, 0.808650f, 0.634492f, 0.699248f},
    {-0.078916f, -0.542729f, -0.922476f, 0.563176f, 0.244112f, 0.357433f},
    {0.418099f, 0.032964f, -0.972141f, 0.804210f, 0.626690f, 0.692642f},
    {-0.000800f, -0.467519f, -0.933337f, 0.608158f, 0.309742f, 0.416630f},
    {-0.048517f, -0.514138f, -0.926900f, 0.581088f, 0.269949f, 0.380828f},
    {-0.424036f, -0.806837f, -0.843121f, 0.309475f, -0.082900f, 0.049910f},
    {0.064929f, -0.399823f, -0.941318f, 0.643533f, 0.363131f, 0.464235f},
    {0.645770f, 0.373681f, -0.985290f, 0.888656f, 0.780185f, 0.821116f},
    {0.005861f, -0.460843f, -0.934190f, 0.611840f, 0.315225f, 0.421541f},
    {0.050763f, -0.414755f, -0.939677f, 0.636085f, 0.351758f, 0.454134f},
    {-0.236137f, -0.676833f, -0.894459f, 0.460781f, 0.103668f, 0.228074f},
    {0.690561f, 0.446408f, -0.987476f, 0.903943f, 0.809158f, 0.845026f},
    {-0.015194f, -0.481807f, -0.931456f, 0.600121f, 0.297833f, 0.405944f},
    {0.085212f, -0.378120f, -0.943598f, 0.654037f, 0.379292f, 0.478551f},
    {-0.252013f, -0.689092f, -0.891032f, 0.449387f, 0.088776f, 0.214130f},
    {0.583334f, 0.275429f, -0.982044f, 0.866667f, 0.739159f, 0.787080f},
    {0.017365f, -0.449214f, -0.935639f, 0.618147f, 0.324657f, 0.429977f},
    {-0.785417f, -0.964227f, -0.554681f, -0.175638f, -0.543320f, -0.430014f},
    {-0.469096f, -0.833114f, -0.826047f, 0.266638f, -0.131543f, 0.002133f},
    {-0.291027f, -0.718218f, -0.882018f, 0.420422f, 0.051556f, 0.179077f},
    {0.240826f, -0.198826f, -0.958743f, 0.728980f, 0.498845f, 0.583158f},
    {-0.899570f, -0.988608f, -0.211281f, -0.478191f, -0.748537f, -0.670036f},
    {0.137302f, -0.320620f, -0.949102f, 0.680191f, 0.420160f, 0.514563f}
};

// 对偶系数
const float dual_coefs[178] = {
    -1.000000f, 0.148848f, -0.066559f, -1.000000f, -1.000000f, -1.000000f, -1.000000f, 1.000000f, 1.000000f, 0.695097f, -0.704808f, 1.000000f, -1.000000f, -1.000000f, 1.000000f, 1.000000f, -1.000000f, -1.000000f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, 1.000000f, 1.000000f, -1.000000f, -1.000000f, 1.000000f, -1.000000f, -1.000000f, 1.000000f, 1.000000f, 0.663293f, -1.000000f, -1.000000f, 1.000000f, -1.000000f, 1.000000f, -1.000000f, 1.000000f, -1.000000f, -0.026667f, -1.000000f, 1.000000f, 1.000000f, -0.248104f, -0.489872f, 0.799436f, 1.000000f, -1.000000f, -0.466894f, -1.000000f, 1.000000f, 1.000000f, -1.000000f, -0.220786f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, 0.756703f, -1.000000f, 0.963726f, 1.000000f, 1.000000f, -1.000000f, -1.000000f, -1.000000f, 1.000000f, -1.000000f, 1.000000f, -1.000000f, 1.000000f, -0.830290f, 0.963188f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, -0.116765f, 1.000000f, -0.332350f, -1.000000f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, 1.000000f, -1.000000f, 1.000000f, -0.183663f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, 1.000000f, -1.000000f, -0.836565f, -1.000000f, -1.000000f, 1.000000f, 0.337127f, -1.000000f, -1.000000f, -1.000000f, 1.000000f, -1.000000f, -1.000000f, 1.000000f, -1.000000f, 0.038796f, -1.000000f, 1.000000f, 0.179173f, -1.000000f, -1.000000f, -0.217250f, 1.000000f, -1.000000f, -0.061969f, 1.000000f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, -1.000000f, -1.000000f, -1.000000f, 1.000000f, -1.000000f, -1.000000f, 0.235216f, -1.000000f, -1.000000f, -1.000000f, -1.000000f, 0.433517f, 0.687741f, 1.000000f, -1.000000f, 1.000000f, -1.000000f, -0.177336f, -0.124905f, 1.000000f, 0.877452f, 1.000000f, 1.000000f, 1.000000f, -1.000000f, 0.090844f, -1.000000f, 1.000000f, 1.000000f, 1.000000f, -0.919036f, -1.000000f, 0.791572f, 1.000000f, 1.000000f, -1.000000f, -1.000000f, -1.000000f, -1.000000f, -1.000000f, -0.637909f, -1.000000f, -1.000000f, -1.000000f, -1.000000f, -1.000000f
};

// -------------------- 3. 辅助函数 --------------------
// RBF核函数
float rbf_kernel(const float* x1, const float* x2, int dim) {
    float sum = 0.0f;
    for (int i = 0; i < dim; i++) {
        float diff = x1[i] - x2[i];
        sum += diff * diff;
    }
    return expf(-gamma * sum);
}

// 特征归一化
void normalize_features(const float* input, float* output, int dim) {
    for (int i = 0; i < dim; i++) {
        output[i] = 2.0f * (input[i] - feat_min[i]) / (feat_max[i] - feat_min[i]) - 1.0f;
    }
}

// 添加基于距离的特征
void add_distance_features(float distance, float* features) {
    // 确保距离非负
    float safe_distance = fmaxf(distance, 0.0f);
    
    // 基本特征
    features[0] = distance;
    features[1] = distance * distance;          // 距离平方
    features[2] = 1.0f / (safe_distance + 1e-6f);   // 距离倒数 (避免除零)
    features[3] = logf(safe_distance + 1e-6f);       // 距离对数
    features[4] = sqrtf(safe_distance);              // 距离平方根
    features[5] = powf(safe_distance, 0.333f);       // 距离立方根
}

// -------------------- 4. 预测函数 --------------------
float predict_rpm(float distance) {
    // 1. 计算特征
    float raw_features[6];
    add_distance_features(distance, raw_features);
    
    // 2. 归一化特征
    float features[6];
    normalize_features(raw_features, features, 6);
    
    // 3. 计算SVR预测
    float sum = intercept;
    for (int i = 0; i < 178; i++) {
        float k = rbf_kernel(features, support_vectors[i], 6);
        sum += dual_coefs[i] * k;
    }
    
    // 4. 反归一化得到实际转速
    float rpm_norm = sum;
    float result = rpm_norm * (rpm_max - rpm_min) + rpm_min;
    
    // 5. 输出保护
    if (result < rpm_min) return rpm_min;
    if (result > rpm_max) return rpm_max;
    return result;
}

// ==================== 使用示例 ====================
/*
#include <stdio.h>
#include <math.h>  // 对于powf, logf等函数

int main() {
    // 测试点: 距离篮筐2米处
    float rpm = predict_rpm(2.0f);
    printf("距离: 2.0米 -> 预测转速: %.1f RPM\n", rpm);
    
    // 测试点: 距离篮筐3.5米处
    rpm = predict_rpm(3.5f);
    printf("距离: 3.5米 -> 预测转速: %.1f RPM\n", rpm);
    
    return 0;
}
*/